fp$1 = 1
f = setClass('f')
f.f1 = 'some'
f.f1
f$f1 = 'some'
f = setClass('f', representation = (f1 = "charactar"))
f$f1 = 'some'
f <- new("f", f1 = 'sth')
f$f1
setClass('f', representation = (f1 = "charactar"))
f <- new("f", f1 = 'sth')
f$f1
setClass('f', representation = (f1 = "charactar"))
f1 <- new("f", f1 = 'sth')
f1$f1
f1
setClass('f', representation = (f1 = "charactar"))
f2 <- new("f", f1 = 'sth')
setClass("f", representation = (f1 = "charactar"))
f2 <- new("f", f1 = 'sth')
setClass("f", representation = (f1 = "charactar"))
f2 <- new("f", f1 = 'sth')
setClass("f", representation = (f1 = "charactar"))
setClass("f", representation = (f1 = "charactar"))
setClass("f", slots = c(f1))
f2 <- new("f", f1 = 'sth')
setClass("f", slots = c(f1))
f2 <- new("f", f1 = 'sth')
ob <- new("f", f1 = 'sth')
setClass("f", slots = c(f1))
ob <- new("f", f1 = 'sth')
setClass("f", slots = c(f1))
setClass("f", slots = c(f1 = "character"))
ob <- new("f", f1 = 'sth')
ob$f1
ob@f1
setClass("f", slots = c(f1))
ob <- new("f", f1 = 'sth')
setClass("f", slots = c(f1 = ))
setClass("f", slots = c(f1 = ))
ob <- new("f", f1 = 'sth')
setClass("f", slots = c(f1))
ob <- new("f", f1 = 'sth')
cat('1', '2')
cat('1', '2pth')
typeof(cat('1', '2pth'))
print(cat('1', '2pth'))
print(cat('1', '2pth'))
(cat('1', '2pth')
cat('1', '2pth')
cat('1', '2pth')
cat("1", "pth")
install.packages("learnr")
plot_corr <- function(dta_fp, pair_name, gtype_name, info_score, fpo) {
df <- read_excel(fp, col_names = F)
n_snps <- nrow(df)
ggplot(data.frame(df), aes(x = ...1)) +
geom_histogram(binwidth = 0.02, fill = "#56B4E9", colour = "#56B4E9", alpha = 0.5) +
labs(title = paste0(pn," Corrs (",gn , ") for SNPS with INFO = ", dn, "-", dn + 0.01, " (n = ", n_snps,")"),
x = "Genotype Correlation",
y = "Count") +
geom_vline(xintercept=0.5, linetype="dotted") +
geom_vline(xintercept=mean(df$...1), linetype="dashed", color = 'red') +
theme_classic() +
theme(legend.position="none")
ggsave(fpo)
}
fp = glue({dta_dir}/'i30.xlsx')
library("data.table")
library("dplyr")
library("plinkFile")
library("genio")
library("ggplot2")
library("glue")
library('readxl')
fp = glue({dta_dir}/'i30.xlsx')
out_dir <- '/var/genetics/ws/mahdimir/DropBox/C1-P-G/A1-Git-SF/imputed-genotype-corr-240317-SF/out/FS-dsg-hist'
dta_dir <- '/var/genetics/ws/mahdimir/LOCAL/proj/imputed-genotype-corr-240317/med/fs-dsg'
fp = glue({dta_dir}/'i30.xlsx')
fp = glue({dta_dir}/'\i30.xlsx')
fp <- glue({dta_dir}/'\i30.xlsx')
fp <- glue({dta_dir}/'i30.xlsx')
fp <- glue('{dta_dir}/i30.xlsx')
df <- read_excel(fp, col_names = F)
out_dir <- '/Users/mmir/Library/CloudStorage/Dropbox/C1-P-G/A1-Git-SF/imputed-genotype-corr-240317-SF/out/fig/FS-dsg-hist'
dta_dir <- '/Users/mmir/Library/CloudStorage/Dropbox/C1-P-G/A1-Git-SF/imputed-genotype-corr-240317-SF/out/dta/FS-dsg-corr'
fp <- glue('{dta_dir}/i30.xlsx')
df <- read_excel(fp, col_names = F)
View(df)
df <- read_excel(fp)
View(df)
df <- read_excel(fp)
df$0
df$0
df$'0'
plot_corr <- function(dta_fp, pair_name, gtype_name, info_score, fpo) {
df <- read_excel(fp, col_names = F)
n_snps <- nrow(df)
dn = info_score / 100
ggplot(data.frame(df), aes(x = 0)) +
geom_histogram(binwidth = 0.02, fill = "#56B4E9", colour = "#56B4E9", alpha = 0.5) +
labs(title = glue('{pair_name}, {gtype_name}, SNPS with INFO = {dn}-{dn+0.01}, n = {n_snps}'),
x = "Genotype Correlation",
y = "Count") +
geom_vline(xintercept=0.5, linetype="dotted") +
geom_vline(xintercept=mean(df$'0'), linetype="dashed", color = 'red') +
theme_classic() +
theme(legend.position="none")
ggsave(fpo)
}
info <- c(30, 40, 50, 60, 70, 80, 90, 99)
out_dir <- '/Users/mmir/Library/CloudStorage/Dropbox/C1-P-G/A1-Git-SF/imputed-genotype-corr-240317-SF/out/fig/FS-dsg-hist'
dta_dir <- '/Users/mmir/Library/CloudStorage/Dropbox/C1-P-G/A1-Git-SF/imputed-genotype-corr-240317-SF/out/dta/FS-dsg-corr'
fp <- glue('{dta_dir}/i30.xlsx')
df <- read_excel(fp)
fpo = glue('{out_dir}/i30.png')
plot_corr(fp, 'FS', 'Dos', 30, fpo)
plot_corr <- function(dta_fp, pair_name, gtype_name, info_score, fpo) {
df <- read_excel(fp, col_names = F)
n_snps <- nrow(df)
dn = info_score / 100
ggplot(data.frame(df), aes(x = 0)) +
geom_histogram(binwidth = 0.02, fill = "#56B4E9", colour = "#56B4E9", alpha = 0.5) +
labs(title = glue('{pair_name}, {gtype_name}, SNPS with INFO = {dn}-{dn+0.01}, n = {n_snps}'),
x = "Genotype Correlation",
y = "Count") +
geom_vline(xintercept=0.5, linetype="dotted") +
geom_vline(xintercept=mean(df$"0"), linetype="dashed", color = 'red') +
theme_classic() +
theme(legend.position="none")
ggsave(fpo)
}
info <- c(30, 40, 50, 60, 70, 80, 90, 99)
out_dir <- '/Users/mmir/Library/CloudStorage/Dropbox/C1-P-G/A1-Git-SF/imputed-genotype-corr-240317-SF/out/fig/FS-dsg-hist'
dta_dir <- '/Users/mmir/Library/CloudStorage/Dropbox/C1-P-G/A1-Git-SF/imputed-genotype-corr-240317-SF/out/dta/FS-dsg-corr'
fp <- glue('{dta_dir}/i30.xlsx')
df <- read_excel(fp)
fpo = glue('{out_dir}/i30.png')
plot_corr(fp, 'FS', 'Dos', 30, fpo)
View(df)
?read_excel
df <- read_excel(fp, col_names = c('snp', 'corr'))
View(df)
plot_corr <- function(dta_fp, pair_name, gtype_name, info_score, fpo) {
df <- read_excel(fp, col_names = F)
n_snps <- nrow(df)
dn = info_score / 100
ggplot(data.frame(df), aes(x = corr)) +
geom_histogram(binwidth = 0.02, fill = "#56B4E9", colour = "#56B4E9", alpha = 0.5) +
labs(title = glue('{pair_name}, {gtype_name}, SNPS with INFO = {dn}-{dn+0.01}, n = {n_snps}'),
x = "Genotype Correlation",
y = "Count") +
geom_vline(xintercept=0.5, linetype="dotted") +
geom_vline(xintercept=mean(df$corr), linetype="dashed", color = 'red') +
theme_classic() +
theme(legend.position="none")
ggsave(fpo)
}
info <- c(30, 40, 50, 60, 70, 80, 90, 99)
out_dir <- '/Users/mmir/Library/CloudStorage/Dropbox/C1-P-G/A1-Git-SF/imputed-genotype-corr-240317-SF/out/fig/FS-dsg-hist'
dta_dir <- '/Users/mmir/Library/CloudStorage/Dropbox/C1-P-G/A1-Git-SF/imputed-genotype-corr-240317-SF/out/dta/FS-dsg-corr'
fp <- glue('{dta_dir}/i30.xlsx')
df <- read_excel(fp, col_names = c('snp', 'corr'))
fpo = glue('{out_dir}/i30.png')
plot_corr(fp, 'FS', 'Dos', 30, fpo)
plot_corr <- function(dta_fp, pair_name, gtype_name, info_score, fpo) {
df <- read_excel(fp, col_names = c('snp', 'corr'))
n_snps <- nrow(df)
dn = info_score / 100
ggplot(data.frame(df), aes(x = corr)) +
geom_histogram(binwidth = 0.02, fill = "#56B4E9", colour = "#56B4E9", alpha = 0.5) +
labs(title = glue('{pair_name}, {gtype_name}, SNPS with INFO = {dn}-{dn+0.01}, n = {n_snps}'),
x = "Genotype Correlation",
y = "Count") +
geom_vline(xintercept=0.5, linetype="dotted") +
geom_vline(xintercept=mean(df$corr), linetype="dashed", color = 'red') +
theme_classic() +
theme(legend.position="none")
ggsave(fpo)
}
info <- c(30, 40, 50, 60, 70, 80, 90, 99)
out_dir <- '/Users/mmir/Library/CloudStorage/Dropbox/C1-P-G/A1-Git-SF/imputed-genotype-corr-240317-SF/out/fig/FS-dsg-hist'
dta_dir <- '/Users/mmir/Library/CloudStorage/Dropbox/C1-P-G/A1-Git-SF/imputed-genotype-corr-240317-SF/out/dta/FS-dsg-corr'
fp <- glue('{dta_dir}/i30.xlsx')
fpo = glue('{out_dir}/i30.png')
plot_corr(fp, 'FS', 'Dos', 30, fpo)
View(df)
?read_excel
plot_corr <- function(dta_fp, pair_name, gtype_name, info_score, fpo) {
df <- read_excel(fp, col_names = c('snp', 'corr'))
n_snps <- nrow(df)
dn = info_score / 100
ggplot(data.frame(df), aes(x = corr)) +
geom_histogram(binwidth = 0.02, fill = "#56B4E9", colour = "#56B4E9", alpha = 0.5) +
labs(title = glue('{pair_name}, {gtype_name}, SNPS with INFO = {dn}-{dn+0.01}, n = {n_snps}'),
x = "Genotype Correlation",
y = "Count") +
geom_vline(xintercept=0.5, linetype="dotted") +
geom_vline(xintercept=mean(df$corr), linetype="dashed", color = 'red') +
theme_classic() +
theme(legend.position="none")
ggsave(fpo)
}
info <- c(30, 40, 50, 60, 70, 80, 90, 99)
out_dir <- '/Users/mmir/Library/CloudStorage/Dropbox/C1-P-G/A1-Git-SF/imputed-genotype-corr-240317-SF/out/fig/FS-dsg-hist'
dta_dir <- '/Users/mmir/Library/CloudStorage/Dropbox/C1-P-G/A1-Git-SF/imputed-genotype-corr-240317-SF/out/dta/FS-dsg-corr'
fp <- glue('{dta_dir}/i30.xlsx')
fpo = glue('{out_dir}/i30.png')
plot_corr(fp, 'FS', 'Dos', 30, fpo)
df <- read_excel(fp, col_names = F)
names(df)
names(df) = c('snp', 'corr')
View(df)
df <- read_excel(fp, col_names = F)
names(df) = c('snp', 'corr')
View(df)
df <- read_excel(fp, col_names = T)
names(df) = c('snp', 'corr')
View(df)
plot_corr <- function(dta_fp, pair_name, gtype_name, info_score, fpo) {
df <- read_excel(fp, col_names = T)
names(df) = c('snp', 'corr')
n_snps <- nrow(df)
dn = info_score / 100
ggplot(data.frame(df), aes(x = corr)) +
geom_histogram(binwidth = 0.02, fill = "#56B4E9", colour = "#56B4E9", alpha = 0.5) +
labs(title = glue('{pair_name}, {gtype_name}, SNPS with INFO = {dn}-{dn+0.01}, n = {n_snps}'),
x = "Genotype Correlation",
y = "Count") +
geom_vline(xintercept=0.5, linetype="dotted") +
geom_vline(xintercept=mean(df$corr), linetype="dashed", color = 'red') +
theme_classic() +
theme(legend.position="none")
ggsave(fpo)
}
info <- c(30, 40, 50, 60, 70, 80, 90, 99)
out_dir <- '/Users/mmir/Library/CloudStorage/Dropbox/C1-P-G/A1-Git-SF/imputed-genotype-corr-240317-SF/out/fig/FS-dsg-hist'
dta_dir <- '/Users/mmir/Library/CloudStorage/Dropbox/C1-P-G/A1-Git-SF/imputed-genotype-corr-240317-SF/out/dta/FS-dsg-corr'
fp <- glue('{dta_dir}/i30.xlsx')
fpo = glue('{out_dir}/i30.png')
plot_corr(fp, 'FS', 'Dos', 30, fpo)
plot_corr <- function(dta_fp, pair_name, gtype_name, info_score, fpo) {
df <- read_excel(fp, col_names = T)
names(df) = c('snp', 'corr')
n_snps <- nrow(df)
dn = info_score / 100
ggplot(data.frame(df), aes(x = corr)) +
geom_histogram(binwidth = 0.02, fill = "#56B4E9", colour = "#56B4E9", alpha = 0.5) +
labs(title = glue('{pair_name}, {gtype_name}, SNPS with INFO = {dn} - {dn+0.01} (n = {n_snps})'),
x = "Genotype Correlation",
y = "Count") +
geom_vline(xintercept=0.5, linetype="dotted") +
geom_vline(xintercept=mean(df$corr), linetype="dashed", color = 'red') +
theme_classic() +
theme(legend.position="none")
ggsave(fpo)
}
info <- c(30, 40, 50, 60, 70, 80, 90, 99)
out_dir <- '/Users/mmir/Library/CloudStorage/Dropbox/C1-P-G/A1-Git-SF/imputed-genotype-corr-240317-SF/out/fig/FS-dsg-hist'
dta_dir <- '/Users/mmir/Library/CloudStorage/Dropbox/C1-P-G/A1-Git-SF/imputed-genotype-corr-240317-SF/out/dta/FS-dsg-corr'
fp <- glue('{dta_dir}/i30.xlsx')
fpo = glue('{out_dir}/i30.png')
plot_corr(fp, 'FS', 'Dos', 30, fpo)
info <- c(30, 40, 50, 60, 70, 80, 90, 99)
out_dir <- '/Users/mmir/Library/CloudStorage/Dropbox/C1-P-G/A1-Git-SF/imputed-genotype-corr-240317-SF/out/fig/FS-dsg-hist'
dta_dir <- '/Users/mmir/Library/CloudStorage/Dropbox/C1-P-G/A1-Git-SF/imputed-genotype-corr-240317-SF/out/dta/FS-dsg-corr'
prd <- expand.grid(out_dir, dta_dir, 'Full Sibs', 'Dosages', info)
View(prd)
typeof(prd)
out_dir <- '/Users/mmir/Library/CloudStorage/Dropbox/C1-P-G/A1-Git-SF/imputed-genotype-corr-240317-SF/out/fig/FS-hc-hist'
dta_dir <- '/Users/mmir/Library/CloudStorage/Dropbox/C1-P-G/A1-Git-SF/imputed-genotype-corr-240317-SF/out/dta/FS-hc-corr'
prd1 <- expand.grid(out_dir, dta_dir, 'Full Sibs', 'Dosages', info)
View(prd1)
out_dir <- '/Users/mmir/Library/CloudStorage/Dropbox/C1-P-G/A1-Git-SF/imputed-genotype-corr-240317-SF/out/fig/FS-hc-hist'
dta_dir <- '/Users/mmir/Library/CloudStorage/Dropbox/C1-P-G/A1-Git-SF/imputed-genotype-corr-240317-SF/out/dta/FS-hc-corr'
prd1 <- expand.grid(out_dir, dta_dir, 'Full Sibs', 'Hard-Call', info)
View(prd1)
prd <- c(prd, prd1)
View(prd)
out_dir <- '/Users/mmir/Library/CloudStorage/Dropbox/C1-P-G/A1-Git-SF/imputed-genotype-corr-240317-SF/out/fig/FS-dsg-hist'
dta_dir <- '/Users/mmir/Library/CloudStorage/Dropbox/C1-P-G/A1-Git-SF/imputed-genotype-corr-240317-SF/out/dta/FS-dsg-corr'
prd <- expand.grid(out_dir, dta_dir, 'Full Sibs', 'Dosages', info)
out_dir <- '/Users/mmir/Library/CloudStorage/Dropbox/C1-P-G/A1-Git-SF/imputed-genotype-corr-240317-SF/out/fig/FS-hc-hist'
dta_dir <- '/Users/mmir/Library/CloudStorage/Dropbox/C1-P-G/A1-Git-SF/imputed-genotype-corr-240317-SF/out/dta/FS-hc-corr'
prd1 <- expand.grid(out_dir, dta_dir, 'Full Sibs', 'Hard-Call', info)
prd <- rbind(prd, prd1)
View(prd)
out_dir <- '/Users/mmir/Library/CloudStorage/Dropbox/C1-P-G/A1-Git-SF/imputed-genotype-corr-240317-SF/out/fig/PO-dsg-hist'
dta_dir <- '/Users/mmir/Library/CloudStorage/Dropbox/C1-P-G/A1-Git-SF/imputed-genotype-corr-240317-SF/out/dta/PO-dsg-corr'
prd1 <- expand.grid(out_dir, dta_dir, 'Parent-Offspring', 'Dosages', info)
prd <- rbind(prd, prd1)
info <- c(30, 40, 50, 60, 70, 80, 90, 99)
out_dir <- '/Users/mmir/Library/CloudStorage/Dropbox/C1-P-G/A1-Git-SF/imputed-genotype-corr-240317-SF/out/fig/FS-dsg-hist'
dta_dir <- '/Users/mmir/Library/CloudStorage/Dropbox/C1-P-G/A1-Git-SF/imputed-genotype-corr-240317-SF/out/dta/FS-dsg-corr'
prd <- expand.grid(out_dir, dta_dir, 'Full Sibs', 'Dosages', info)
out_dir <- '/Users/mmir/Library/CloudStorage/Dropbox/C1-P-G/A1-Git-SF/imputed-genotype-corr-240317-SF/out/fig/FS-hc-hist'
dta_dir <- '/Users/mmir/Library/CloudStorage/Dropbox/C1-P-G/A1-Git-SF/imputed-genotype-corr-240317-SF/out/dta/FS-hc-corr'
prd1 <- expand.grid(out_dir, dta_dir, 'Full Sibs', 'Hard-Call', info)
prd <- rbind(prd, prd1)
out_dir <- '/Users/mmir/Library/CloudStorage/Dropbox/C1-P-G/A1-Git-SF/imputed-genotype-corr-240317-SF/out/fig/PO-dsg-hist'
dta_dir <- '/Users/mmir/Library/CloudStorage/Dropbox/C1-P-G/A1-Git-SF/imputed-genotype-corr-240317-SF/out/dta/PO-dsg-corr'
prd1 <- expand.grid(out_dir, dta_dir, 'Parent-Offspring', 'Dosages', info)
prd <- rbind(prd, prd1)
out_dir <- '/Users/mmir/Library/CloudStorage/Dropbox/C1-P-G/A1-Git-SF/imputed-genotype-corr-240317-SF/out/fig/PO-hc-hist'
dta_dir <- '/Users/mmir/Library/CloudStorage/Dropbox/C1-P-G/A1-Git-SF/imputed-genotype-corr-240317-SF/out/dta/PO-hc-corr'
prd1 <- expand.grid(out_dir, dta_dir, 'Parent-Offspring', 'Hard-Call', info)
prd <- rbind(prd, prd1)
View(prd1)
View(prd)
View(prd)
plot_corr <- function(dta_fp, pair_name, gtype_name, info_score, fpo) {
df <- read_excel(fp, col_names = T)
names(df) = c('snp', 'corr')
n_snps <- nrow(df)
dn = info_score / 100
ggplot(data.frame(df), aes(x = corr)) +
geom_histogram(binwidth = 0.02, fill = "#56B4E9", colour = "#56B4E9", alpha = 0.5) +
labs(title = glue('{pair_name}, {gtype_name}, SNPS with INFO = {dn} - {dn+0.01} (n = {n_snps})'),
x = "Genotype Correlation",
y = "Count") +
geom_vline(xintercept=0.5, linetype="dotted") +
geom_vline(xintercept=mean(df$corr), linetype="dashed", color = 'red') +
theme_classic() +
theme(legend.position="none")
ggsave(fpo)
}
info <- c(30, 40, 50, 60, 70, 80, 90, 99)
out_dir <- '/Users/mmir/Library/CloudStorage/Dropbox/C1-P-G/A1-Git-SF/imputed-genotype-corr-240317-SF/out/fig/FS-dsg-hist'
dta_dir <- '/Users/mmir/Library/CloudStorage/Dropbox/C1-P-G/A1-Git-SF/imputed-genotype-corr-240317-SF/out/dta/FS-dsg-corr'
prd <- expand.grid(out_dir, dta_dir, 'Full Sibs', 'Dosages', info)
out_dir <- '/Users/mmir/Library/CloudStorage/Dropbox/C1-P-G/A1-Git-SF/imputed-genotype-corr-240317-SF/out/fig/FS-hc-hist'
dta_dir <- '/Users/mmir/Library/CloudStorage/Dropbox/C1-P-G/A1-Git-SF/imputed-genotype-corr-240317-SF/out/dta/FS-hc-corr'
prd1 <- expand.grid(out_dir, dta_dir, 'Full Sibs', 'Hard-Call', info)
prd <- rbind(prd, prd1)
out_dir <- '/Users/mmir/Library/CloudStorage/Dropbox/C1-P-G/A1-Git-SF/imputed-genotype-corr-240317-SF/out/fig/PO-dsg-hist'
dta_dir <- '/Users/mmir/Library/CloudStorage/Dropbox/C1-P-G/A1-Git-SF/imputed-genotype-corr-240317-SF/out/dta/PO-dsg-corr'
prd1 <- expand.grid(out_dir, dta_dir, 'Parent-Offspring', 'Dosages', info)
prd <- rbind(prd, prd1)
out_dir <- '/Users/mmir/Library/CloudStorage/Dropbox/C1-P-G/A1-Git-SF/imputed-genotype-corr-240317-SF/out/fig/PO-hc-hist'
dta_dir <- '/Users/mmir/Library/CloudStorage/Dropbox/C1-P-G/A1-Git-SF/imputed-genotype-corr-240317-SF/out/dta/PO-hc-corr'
prd1 <- expand.grid(out_dir, dta_dir, 'Parent-Offspring', 'Hard-Call', info)
prd <- rbind(prd, prd1)
for (x in 1:nrow(prd))
{
pair_name = prd[x, 'Var3']
gtype_name = prd[x, 'Var4']
info_score = prd[x, 'Var5']
dta_fp = glue("{prd[x, 'Var2']}/i{info_score}.xlsx")
fpo = glue("{prd[x, 'Var1']}/i{info_score}.xlsx")
plot_corr(dta_fp,pair_name,gtype_name,info_score, fpo)
}
plot_corr <- function(dta_fp, pair_name, gtype_name, info_score, fpo) {
df <- read_excel(fp, col_names = T)
names(df) = c('snp', 'corr')
n_snps <- nrow(df)
dn = info_score / 100
ggplot(data.frame(df), aes(x = corr)) +
geom_histogram(binwidth = 0.02, fill = "#56B4E9", colour = "#56B4E9", alpha = 0.5) +
labs(title = glue('{pair_name}, {gtype_name}, SNPS with INFO = {dn} - {dn+0.01} (n = {n_snps})'),
x = "Genotype Correlation",
y = "Count") +
geom_vline(xintercept=0.5, linetype="dotted") +
geom_vline(xintercept=mean(df$corr), linetype="dashed", color = 'red') +
theme_classic() +
theme(legend.position="none")
ggsave(fpo)
}
info <- c(30, 40, 50, 60, 70, 80, 90, 99)
out_dir <- '/Users/mmir/Library/CloudStorage/Dropbox/C1-P-G/A1-Git-SF/imputed-genotype-corr-240317-SF/out/fig/FS-dsg-hist'
dta_dir <- '/Users/mmir/Library/CloudStorage/Dropbox/C1-P-G/A1-Git-SF/imputed-genotype-corr-240317-SF/out/dta/FS-dsg-corr'
prd <- expand.grid(out_dir, dta_dir, 'Full Sibs', 'Dosages', info)
out_dir <- '/Users/mmir/Library/CloudStorage/Dropbox/C1-P-G/A1-Git-SF/imputed-genotype-corr-240317-SF/out/fig/FS-hc-hist'
dta_dir <- '/Users/mmir/Library/CloudStorage/Dropbox/C1-P-G/A1-Git-SF/imputed-genotype-corr-240317-SF/out/dta/FS-hc-corr'
prd1 <- expand.grid(out_dir, dta_dir, 'Full Sibs', 'Hard-Call', info)
prd <- rbind(prd, prd1)
out_dir <- '/Users/mmir/Library/CloudStorage/Dropbox/C1-P-G/A1-Git-SF/imputed-genotype-corr-240317-SF/out/fig/PO-dsg-hist'
dta_dir <- '/Users/mmir/Library/CloudStorage/Dropbox/C1-P-G/A1-Git-SF/imputed-genotype-corr-240317-SF/out/dta/PO-dsg-corr'
prd1 <- expand.grid(out_dir, dta_dir, 'Parent-Offspring', 'Dosages', info)
prd <- rbind(prd, prd1)
out_dir <- '/Users/mmir/Library/CloudStorage/Dropbox/C1-P-G/A1-Git-SF/imputed-genotype-corr-240317-SF/out/fig/PO-hc-hist'
dta_dir <- '/Users/mmir/Library/CloudStorage/Dropbox/C1-P-G/A1-Git-SF/imputed-genotype-corr-240317-SF/out/dta/PO-hc-corr'
prd1 <- expand.grid(out_dir, dta_dir, 'Parent-Offspring', 'Hard-Call', info)
prd <- rbind(prd, prd1)
for (x in 1:nrow(prd))
{
pair_name = prd[x, 'Var3']
gtype_name = prd[x, 'Var4']
info_score = prd[x, 'Var5']
dta_fp = glue("{prd[x, 'Var2']}/i{info_score}.xlsx")
fpo = glue("{prd[x, 'Var1']}/i{info_score}.png")
plot_corr(dta_fp,pair_name,gtype_name,info_score, fpo)
}
plot_corr <- function(dta_fp, pair_name, gtype_name, info_score, fpo) {
df <- read_excel(dta_fp, col_names = T)
names(df) = c('snp', 'corr')
n_snps <- nrow(df)
dn = info_score / 100
ggplot(data.frame(df), aes(x = corr)) +
geom_histogram(binwidth = 0.02, fill = "#56B4E9", colour = "#56B4E9", alpha = 0.5) +
labs(title = glue('{pair_name}, {gtype_name}, SNPS with INFO = {dn} - {dn+0.01} (n = {n_snps})'),
x = "Genotype Correlation",
y = "Count") +
geom_vline(xintercept=0.5, linetype="dotted") +
geom_vline(xintercept=mean(df$corr), linetype="dashed", color = 'red') +
theme_classic() +
theme(legend.position="none")
ggsave(fpo)
}
info <- c(30, 40, 50, 60, 70, 80, 90, 99)
out_dir <- '/Users/mmir/Library/CloudStorage/Dropbox/C1-P-G/A1-Git-SF/imputed-genotype-corr-240317-SF/out/fig/FS-dsg-hist'
dta_dir <- '/Users/mmir/Library/CloudStorage/Dropbox/C1-P-G/A1-Git-SF/imputed-genotype-corr-240317-SF/out/dta/FS-dsg-corr'
prd <- expand.grid(out_dir, dta_dir, 'Full Sibs', 'Dosages', info)
out_dir <- '/Users/mmir/Library/CloudStorage/Dropbox/C1-P-G/A1-Git-SF/imputed-genotype-corr-240317-SF/out/fig/FS-hc-hist'
dta_dir <- '/Users/mmir/Library/CloudStorage/Dropbox/C1-P-G/A1-Git-SF/imputed-genotype-corr-240317-SF/out/dta/FS-hc-corr'
prd1 <- expand.grid(out_dir, dta_dir, 'Full Sibs', 'Hard-Call', info)
prd <- rbind(prd, prd1)
out_dir <- '/Users/mmir/Library/CloudStorage/Dropbox/C1-P-G/A1-Git-SF/imputed-genotype-corr-240317-SF/out/fig/PO-dsg-hist'
dta_dir <- '/Users/mmir/Library/CloudStorage/Dropbox/C1-P-G/A1-Git-SF/imputed-genotype-corr-240317-SF/out/dta/PO-dsg-corr'
prd1 <- expand.grid(out_dir, dta_dir, 'Parent-Offspring', 'Dosages', info)
prd <- rbind(prd, prd1)
out_dir <- '/Users/mmir/Library/CloudStorage/Dropbox/C1-P-G/A1-Git-SF/imputed-genotype-corr-240317-SF/out/fig/PO-hc-hist'
dta_dir <- '/Users/mmir/Library/CloudStorage/Dropbox/C1-P-G/A1-Git-SF/imputed-genotype-corr-240317-SF/out/dta/PO-hc-corr'
prd1 <- expand.grid(out_dir, dta_dir, 'Parent-Offspring', 'Hard-Call', info)
prd <- rbind(prd, prd1)
for (x in 1:nrow(prd))
{
pair_name = prd[x, 'Var3']
gtype_name = prd[x, 'Var4']
info_score = prd[x, 'Var5']
dta_fp = glue("{prd[x, 'Var2']}/i{info_score}.xlsx")
fpo = glue("{prd[x, 'Var1']}/i{info_score}.png")
plot_corr(dta_fp,pair_name,gtype_name,info_score, fpo)
}
View(prd)
fp = glue("{prd[18, 'Var2']}/i40.xlsx")
df <- read_excel(fp,col_names = T)
View(df)
df <- read_excel(fp,col_names = T)
names(df) = c('snp', 'corr')
mean(df$corr)
View(df)
any(df$corr)
is.na(df$corr)
which(is.na(df$corr))
df <- read_excel(fp,col_names = T)
names(df) = c('snp', 'corr')
mean(df$corr)
df <- na.omit(df)
mean(df$corr)
plot_corr <- function(dta_fp, pair_name, gtype_name, info_score, fpo) {
df <- read_excel(dta_fp, col_names = T)
names(df) = c('snp', 'corr')
df <- na.omit(df)
n_snps <- nrow(df)
dn = info_score / 100
ggplot(data.frame(df), aes(x = corr)) +
geom_histogram(binwidth = 0.02, fill = "#56B4E9", colour = "#56B4E9", alpha = 0.5) +
labs(title = glue('{pair_name}, {gtype_name}, SNPS with INFO = {dn} - {dn+0.01} (n = {n_snps})'),
x = "Genotype Correlation",
y = "Count") +
geom_vline(xintercept=0.5, linetype="dotted") +
geom_vline(xintercept=mean(df$corr), linetype="dashed", color = 'red') +
theme_classic() +
theme(legend.position="none")
ggsave(fpo)
}
info <- c(30, 40, 50, 60, 70, 80, 90, 99)
out_dir <- '/Users/mmir/Library/CloudStorage/Dropbox/C1-P-G/A1-Git-SF/imputed-genotype-corr-240317-SF/out/fig/FS-dsg-hist'
dta_dir <- '/Users/mmir/Library/CloudStorage/Dropbox/C1-P-G/A1-Git-SF/imputed-genotype-corr-240317-SF/out/dta/FS-dsg-corr'
prd <- expand.grid(out_dir, dta_dir, 'Full Sibs', 'Dosages', info)
out_dir <- '/Users/mmir/Library/CloudStorage/Dropbox/C1-P-G/A1-Git-SF/imputed-genotype-corr-240317-SF/out/fig/FS-hc-hist'
dta_dir <- '/Users/mmir/Library/CloudStorage/Dropbox/C1-P-G/A1-Git-SF/imputed-genotype-corr-240317-SF/out/dta/FS-hc-corr'
prd1 <- expand.grid(out_dir, dta_dir, 'Full Sibs', 'Hard-Call', info)
prd <- rbind(prd, prd1)
out_dir <- '/Users/mmir/Library/CloudStorage/Dropbox/C1-P-G/A1-Git-SF/imputed-genotype-corr-240317-SF/out/fig/PO-dsg-hist'
dta_dir <- '/Users/mmir/Library/CloudStorage/Dropbox/C1-P-G/A1-Git-SF/imputed-genotype-corr-240317-SF/out/dta/PO-dsg-corr'
prd1 <- expand.grid(out_dir, dta_dir, 'Parent-Offspring', 'Dosages', info)
prd <- rbind(prd, prd1)
out_dir <- '/Users/mmir/Library/CloudStorage/Dropbox/C1-P-G/A1-Git-SF/imputed-genotype-corr-240317-SF/out/fig/PO-hc-hist'
dta_dir <- '/Users/mmir/Library/CloudStorage/Dropbox/C1-P-G/A1-Git-SF/imputed-genotype-corr-240317-SF/out/dta/PO-hc-corr'
prd1 <- expand.grid(out_dir, dta_dir, 'Parent-Offspring', 'Hard-Call', info)
prd <- rbind(prd, prd1)
for (x in 1:nrow(prd))
{
pair_name = prd[x, 'Var3']
gtype_name = prd[x, 'Var4']
info_score = prd[x, 'Var5']
dta_fp = glue("{prd[x, 'Var2']}/i{info_score}.xlsx")
fpo = glue("{prd[x, 'Var1']}/i{info_score}.png")
plot_corr(dta_fp,pair_name,gtype_name,info_score, fpo)
}
path <- '/Users/mmir/Library/CloudStorage/Dropbox/C1-P-G/A1-Git-SF/imputed-genotype-corr-240317-SF/out/dta/corrs.xlsx'
df <- read_excel(path)
View(df)
View(df)
